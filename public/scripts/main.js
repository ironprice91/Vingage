var Video=Backbone.Model.extend({idAttributes:"_id",defaults:{title:"Why Internet Explorer is the best",videoSrc:"",notes:[{time:0,note:""}]}}),VideoList=Backbone.Collection.extend({model:Video,url:"/videos"}),VideoListView=Backbone.View.extend({template:Handlebars.compile($("#video-list").html()),initialize:function(){this.setElement(this.template(this.attributes)),this.listenTo(this.collection,"all",this.render)},render:function(){var t=this.collection.map(function(t){var e=new VideoView({model:t});return e.render(),e.el});this.$(".videos").empty().append(t)}}),VideoView=Backbone.View.extend({template:Handlebars.compile($("#video-tpl").html()),render:function(){this.setElement(this.template(this.model.toJSON()))},events:{"click .deleteVideo":"deleteVideo"},deleteVideo:function(){console.log(this.model.attributes._id),this.model.destroy()}});!function t(e,o,n){function i(a,d){if(!o[a]){if(!e[a]){var s="function"==typeof require&&require;if(!d&&s)return s(a,!0);if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=o[a]={exports:{}};e[a][0].call(c.exports,function(t){var o=e[a][1][t];return i(o?o:t)},c,c.exports,t,e,o,n)}return o[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(t){var e=t("./modules/Helper"),o=new VideoList;o.reset(bootstrappedVideos);var n=new VideoListView({attributes:{title:"Video Quick View"},collection:o}),i='<form id="submit-note"><textarea name="note" class="new-note" placeholder="Note..."></textarea><button class="cancel-note btn btn-danger">Cancel</button><button type="submit" class="btn btn-primary pull-right submit-note-btn">Save</button><form>',r='<button class="btn btn-success popover-btn edit-note">Edit  </button><button class="btn btn-danger popover-btn delete-note">Delete</button><button id="close-popover" data-toggle="clickover" class="btn btn-small btn-primary popover-btn" onclick="$(&quot;.note-row&quot;).popover(&quot;hide&quot;);">Close</button>';$(function(){$("#username-input").focus(),$(document).ready(function(){$(".splash-logo").removeClass("hidden"),$(".splash-logo").fadeIn(3e3)}),n.render(),$("body").append(n.el),$(document).on("click",".note-row",function(t){t.stopPropagation(),$(".note-row").popover({animation:!0,content:r,placement:"left",html:!0})}),$(document).on("click",".delete-note",function(){var t=$(this).closest("li"),e=t.find("video"),o=e.attr("id"),n=$(this).parent(),i=n.parent().prev().attr("id");$.post("/deleteNote",{id:i,videoId:o},function(t){console.log("responseData.success: ",t.success),t.success===!0&&($("#"+i).remove(),$(".popover").remove())})}),$(document).on("click",".edit-note",function(t){t.preventDefault();var e=$(this).closest("li"),o=e.find("video"),n=o.attr("id"),i=$(this).parent(),r=i.parent().prev().attr("id"),a='<form id="edit-note"><textarea id="edit-note-form" name="editNoteForm" cols="37" rows="8"></textarea><input type="submit" class="btn btn-default"></form>';$(i).append(a);var d="/getNote/"+n+"-"+r,s=$("#edit-note-form");$.get(d,function(t){s.val(t)}),$(document).on("submit","#edit-note",function(t){t.preventDefault();var e="updateNote/"+n+"-"+r,o=$("#edit-note"),a=o.find("[name=editNoteForm]").val(),d={note:a};$.post(e,d,function(t){i.parent().prev().find("p").text(t.note);$(".popover").remove()})})}),$(document).on("click",".toggle-new-note",function(){var t=$(this).closest("li"),o=t.find("video"),n=o.attr("id"),r=document.getElementById(n);r.pause();var a=t.find("table.list-notes");a.prepend(i),$(document).on("click",".cancel-note",function(t){t.preventDefault(),$("#submit-note").remove()}),$(document).on("submit","#submit-note",function(t){t.preventDefault(),t.stopPropagation();var o=$(this).find("textarea").val(),i=$(this).closest("table"),a=r.currentTime,d=e.timeConvert(a);$.post("/saveNote",{id:n,note:o,time:a,displayTime:d},function(t){var o=e.renderNote(t);i.append(o)}),this.remove(),r.play()})}),$(document).on("click",".deleteVideo",function(){var t=$(this).closest("li"),e=t.attr("data-video-container");$.post("/deleteVideo",{id:e},function(e){console.log("responseData: ",e),e.success===!0&&t.remove()})}),$(document).on("click",".set-time",function(t){t.stopPropagation();var e=$(this).closest("li"),o=e.find("video"),n=o.attr("id"),i=document.getElementById(n),r=$(this).attr("data-set-time");i.currentTime=Number(r)}),$(document).on("click",".theater-mode",function(){var t=$(this).closest("li"),e=$("#theater-mode"),o=t.attr("data-video-container"),n="/theaterMode/"+o;console.log(o),$.get(n,{},function(t){var n=$(".video-modal").find("video");$(".video-theater").attr("src",t[0].videoSrc),$(".video-modal").attr("src",t[0].videoSrc),$(".theater-container").attr("data-video-container",o),$(".video-modal").attr("id",o),$(".video-modal").attr("data-video",o),n.attr("src",t[0].videoSrc),n.attr("id",t[0]._id+"_html5_api"),n.attr("data-video",t[0]._id),e.modal("show")})})})},{"./modules/Helper":2}],2:[function(t,e){e.exports={timeConvert:function(t){var e=Math.floor(t/60),o=t-60*e,n=Math.floor(o),i=n.toString().split("");return 1===i.length?wholeNumber+":0"+n:wholeNumber+":"+n},renderNote:function(t){var e=$("<tr>");return e.attr("data-note",t._id),e.attr("id",t._id),e.attr("class","note-row"),e.append('<td><button class="set-time btn btn-default" data-set-time="'+t.time+'">'+t.displayTime+"</button><p>"+t.note+"</p></td>"),e}}},{}]},{},[1]);