var Video=Backbone.Model.extend({idAttributes:"_id",defaults:{title:"Why Internet Explorer is the best",videoSrc:"",notes:[{time:0,note:""}]}}),VideoList=Backbone.Collection.extend({model:Video,url:"/videos"}),VideoListView=Backbone.View.extend({template:Handlebars.compile($("#video-list").html()),initialize:function(){this.setElement(this.template(this.attributes)),this.listenTo(this.collection,"all",this.render)},render:function(){var t=this.collection.map(function(t){var n=new VideoView({model:t});return n.render(),n.el});this.$(".videos").empty().append(t)}}),VideoView=Backbone.View.extend({template:Handlebars.compile($("#video-tpl").html()),render:function(){this.setElement(this.template(this.model.toJSON()))},events:{"click .deleteVideo":"deleteVideo"},deleteVideo:function(){console.log(this.model.attributes._id),this.model.destroy()}});!function t(n,e,r){function o(a,u){if(!e[a]){if(!n[a]){var c="function"==typeof require&&require;if(!u&&c)return c(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var s=e[a]={exports:{}};n[a][0].call(s.exports,function(t){var e=n[a][1][t];return o(e?e:t)},s,s.exports,t,n,e,r)}return e[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t){var n=t("./modules/Helper"),e=t("async");console.log(e);var r=new VideoList;r.reset(bootstrappedVideos);var o=new VideoListView({attributes:{title:"Video Quick View"},collection:r}),i='<form id="submit-note">		<textarea name="note" class="new-note" placeholder="Note..."></textarea>		<button class="cancel-note btn btn-danger">Cancel</button>		<button type="submit" class="btn btn-primary pull-right submit-note-btn">Save</button>	<form>',a='<button class="btn btn-success popover-btn edit-note">Edit  </button>    <button class="btn btn-danger popover-btn delete-note">Delete</button>    <button id="close-popover" data-toggle="clickover" class="btn btn-small btn-primary popover-btn" onclick="$(&quot;.note-row&quot;).popover(&quot;hide&quot;);">Close</button>';$(function(){$("#username-input").focus(),$(document).ready(function(){$(".splash-logo").removeClass("hidden"),$(".splash-logo").fadeIn(3e3)}),o.render(),$("body").append(o.el),$(document).on("click",".note-row",function(t){t.stopPropagation(),$(".note-row").popover({animation:!0,content:a,placement:"left",html:!0})}),$(document).on("click",".delete-note",function(){var t=$(this).closest("li"),n=t.find("video"),e=n.attr("id"),r=$(this).parent(),o=r.parent().prev().attr("id");$.post("/deleteNote",{id:o,videoId:e},function(t){console.log("responseData.success: ",t.success),t.success===!0&&($("#"+o).remove(),$(".popover").remove())})}),$(document).on("click",".edit-note",function(t){t.preventDefault();var n=$(this).closest("li"),e=n.find("video"),r=e.attr("id"),o=$(this).parent(),i=o.parent().prev().attr("id"),a='<form id="edit-note"><textarea id="edit-note-form" name="editNoteForm" cols="37" rows="8"></textarea><input type="submit" class="btn btn-default"></form>';$(o).append(a);var u="/getNote/"+r+"-"+i,c=$("#edit-note-form");$.get(u,function(t){c.val(t)}),$(document).on("submit","#edit-note",function(t){t.preventDefault();var n="updateNote/"+r+"-"+i,e=$("#edit-note"),a=e.find("[name=editNoteForm]").val(),u={note:a};$.post(n,u,function(t){o.parent().prev().find("p").text(t.note);$(".popover").remove()})})}),$(document).on("click",".toggle-new-note",function(){var t=$(this).closest("li"),e=t.find("video"),r=e.attr("id"),o=document.getElementById(r);o.pause();var a=t.find("table.list-notes");a.prepend(i),$(document).on("click",".cancel-note",function(t){t.preventDefault(),$("#submit-note").remove()}),$(document).on("submit","#submit-note",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).find("textarea").val(),i=$(this).closest("table"),a=o.currentTime,u=n.timeConvert(a);$.post("/saveNote",{id:r,note:e,time:a,displayTime:u},function(t){var e=n.renderNote(t);i.append(e)}),this.remove(),o.play()})}),$(document).on("click",".deleteVideo",function(){var t=$(this).closest("li"),n=t.attr("data-video-container");$.post("/deleteVideo",{id:n},function(n){console.log("responseData: ",n),n.success===!0&&t.remove()})}),$(document).on("click",".set-time",function(t){t.stopPropagation();var n=$(this).closest("li"),e=n.find("video"),r=e.attr("id"),o=document.getElementById(r),i=$(this).attr("data-set-time");o.currentTime=Number(i)}),$(document).on("click",".theater-mode",function(){var t=$(this).closest("li"),n=$("#theater-mode"),e=t.attr("data-video-container"),r="/theaterMode/"+e;console.log(e),$.get(r,{},function(t){var r=$(".video-modal").find("video");$(".video-theater").attr("src",t[0].videoSrc),$(".video-modal").attr("src",t[0].videoSrc),$(".theater-container").attr("data-video-container",e),$(".video-modal").attr("id",e),$(".video-modal").attr("data-video",e),r.attr("src",t[0].videoSrc),r.attr("id",t[0]._id+"_html5_api"),r.attr("data-video",t[0]._id),n.modal("show")})})})},{"./modules/Helper":4,async:2}],2:[function(t,n){(function(t){!function(){function e(t){var n=!1;return function(){if(n)throw new Error("Callback was already called.");n=!0,t.apply(r,arguments)}}var r,o,i={};r=this,null!=r&&(o=r.async),i.noConflict=function(){return r.async=o,i};var a=Object.prototype.toString,u=Array.isArray||function(t){return"[object Array]"===a.call(t)},c=function(t,n){if(t.forEach)return t.forEach(n);for(var e=0;e<t.length;e+=1)n(t[e],e,t)},l=function(t,n){if(t.map)return t.map(n);var e=[];return c(t,function(t,r,o){e.push(n(t,r,o))}),e},s=function(t,n,e){return t.reduce?t.reduce(n,e):(c(t,function(t,r,o){e=n(e,t,r,o)}),e)},f=function(t){if(Object.keys)return Object.keys(t);var n=[];for(var e in t)t.hasOwnProperty(e)&&n.push(e);return n};"undefined"!=typeof t&&t.nextTick?(i.nextTick=t.nextTick,i.setImmediate="undefined"!=typeof setImmediate?function(t){setImmediate(t)}:i.nextTick):"function"==typeof setImmediate?(i.nextTick=function(t){setImmediate(t)},i.setImmediate=i.nextTick):(i.nextTick=function(t){setTimeout(t,0)},i.setImmediate=i.nextTick),i.each=function(t,n,r){function o(n){n?(r(n),r=function(){}):(i+=1,i>=t.length&&r())}if(r=r||function(){},!t.length)return r();var i=0;c(t,function(t){n(t,e(o))})},i.forEach=i.each,i.eachSeries=function(t,n,e){if(e=e||function(){},!t.length)return e();var r=0,o=function(){n(t[r],function(n){n?(e(n),e=function(){}):(r+=1,r>=t.length?e():o())})};o()},i.forEachSeries=i.eachSeries,i.eachLimit=function(t,n,e,r){var o=d(n);o.apply(null,[t,e,r])},i.forEachLimit=i.eachLimit;var d=function(t){return function(n,e,r){if(r=r||function(){},!n.length||0>=t)return r();var o=0,i=0,a=0;!function u(){if(o>=n.length)return r();for(;t>a&&i<n.length;)i+=1,a+=1,e(n[i-1],function(t){t?(r(t),r=function(){}):(o+=1,a-=1,o>=n.length?r():u())})}()}},p=function(t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[i.each].concat(n))}},m=function(t,n){return function(){var e=Array.prototype.slice.call(arguments);return n.apply(null,[d(t)].concat(e))}},v=function(t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[i.eachSeries].concat(n))}},h=function(t,n,e,r){if(n=l(n,function(t,n){return{index:n,value:t}}),r){var o=[];t(n,function(t,n){e(t.value,function(e,r){o[t.index]=r,n(e)})},function(t){r(t,o)})}else t(n,function(t,n){e(t.value,function(t){n(t)})})};i.map=p(h),i.mapSeries=v(h),i.mapLimit=function(t,n,e,r){return y(n)(t,e,r)};var y=function(t){return m(t,h)};i.reduce=function(t,n,e,r){i.eachSeries(t,function(t,r){e(n,t,function(t,e){n=e,r(t)})},function(t){r(t,n)})},i.inject=i.reduce,i.foldl=i.reduce,i.reduceRight=function(t,n,e,r){var o=l(t,function(t){return t}).reverse();i.reduce(o,n,e,r)},i.foldr=i.reduceRight;var g=function(t,n,e,r){var o=[];n=l(n,function(t,n){return{index:n,value:t}}),t(n,function(t,n){e(t.value,function(e){e&&o.push(t),n()})},function(){r(l(o.sort(function(t,n){return t.index-n.index}),function(t){return t.value}))})};i.filter=p(g),i.filterSeries=v(g),i.select=i.filter,i.selectSeries=i.filterSeries;var b=function(t,n,e,r){var o=[];n=l(n,function(t,n){return{index:n,value:t}}),t(n,function(t,n){e(t.value,function(e){e||o.push(t),n()})},function(){r(l(o.sort(function(t,n){return t.index-n.index}),function(t){return t.value}))})};i.reject=p(b),i.rejectSeries=v(b);var k=function(t,n,e,r){t(n,function(t,n){e(t,function(e){e?(r(t),r=function(){}):n()})},function(){r()})};i.detect=p(k),i.detectSeries=v(k),i.some=function(t,n,e){i.each(t,function(t,r){n(t,function(t){t&&(e(!0),e=function(){}),r()})},function(){e(!1)})},i.any=i.some,i.every=function(t,n,e){i.each(t,function(t,r){n(t,function(t){t||(e(!1),e=function(){}),r()})},function(){e(!0)})},i.all=i.every,i.sortBy=function(t,n,e){i.map(t,function(t,e){n(t,function(n,r){n?e(n):e(null,{value:t,criteria:r})})},function(t,n){if(t)return e(t);var r=function(t,n){var e=t.criteria,r=n.criteria;return r>e?-1:e>r?1:0};e(null,l(n.sort(r),function(t){return t.value}))})},i.auto=function(t,n){n=n||function(){};var e=f(t),r=e.length;if(!r)return n();var o={},a=[],l=function(t){a.unshift(t)},d=function(t){for(var n=0;n<a.length;n+=1)if(a[n]===t)return void a.splice(n,1)},p=function(){r--,c(a.slice(0),function(t){t()})};l(function(){if(!r){var t=n;n=function(){},t(null,o)}}),c(e,function(e){var r=u(t[e])?t[e]:[t[e]],a=function(t){var r=Array.prototype.slice.call(arguments,1);if(r.length<=1&&(r=r[0]),t){var a={};c(f(o),function(t){a[t]=o[t]}),a[e]=r,n(t,a),n=function(){}}else o[e]=r,i.setImmediate(p)},m=r.slice(0,Math.abs(r.length-1))||[],v=function(){return s(m,function(t,n){return t&&o.hasOwnProperty(n)},!0)&&!o.hasOwnProperty(e)};if(v())r[r.length-1](a,o);else{var h=function(){v()&&(d(h),r[r.length-1](a,o))};l(h)}})},i.retry=function(t,n,e){var r=5,o=[];"function"==typeof t&&(e=n,n=t,t=r),t=parseInt(t,10)||r;var a=function(r,a){for(var u=function(t,n){return function(e){t(function(t,r){e(!t||n,{err:t,result:r})},a)}};t;)o.push(u(n,!(t-=1)));i.series(o,function(t,n){n=n[n.length-1],(r||e)(n.err,n.result)})};return e?a():a},i.waterfall=function(t,n){if(n=n||function(){},!u(t)){var e=new Error("First argument to waterfall must be an array of functions");return n(e)}if(!t.length)return n();var r=function(t){return function(e){if(e)n.apply(null,arguments),n=function(){};else{var o=Array.prototype.slice.call(arguments,1),a=t.next();o.push(a?r(a):n),i.setImmediate(function(){t.apply(null,o)})}}};r(i.iterator(t))()};var $=function(t,n,e){if(e=e||function(){},u(n))t.map(n,function(t,n){t&&t(function(t){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),n.call(null,t,e)})},e);else{var r={};t.each(f(n),function(t,e){n[t](function(n){var o=Array.prototype.slice.call(arguments,1);o.length<=1&&(o=o[0]),r[t]=o,e(n)})},function(t){e(t,r)})}};i.parallel=function(t,n){$({map:i.map,each:i.each},t,n)},i.parallelLimit=function(t,n,e){$({map:y(n),each:d(n)},t,e)},i.series=function(t,n){if(n=n||function(){},u(t))i.mapSeries(t,function(t,n){t&&t(function(t){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),n.call(null,t,e)})},n);else{var e={};i.eachSeries(f(t),function(n,r){t[n](function(t){var o=Array.prototype.slice.call(arguments,1);o.length<=1&&(o=o[0]),e[n]=o,r(t)})},function(t){n(t,e)})}},i.iterator=function(t){var n=function(e){var r=function(){return t.length&&t[e].apply(null,arguments),r.next()};return r.next=function(){return e<t.length-1?n(e+1):null},r};return n(0)},i.apply=function(t){var n=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,n.concat(Array.prototype.slice.call(arguments)))}};var x=function(t,n,e,r){var o=[];t(n,function(t,n){e(t,function(t,e){o=o.concat(e||[]),n(t)})},function(t){r(t,o)})};i.concat=p(x),i.concatSeries=v(x),i.whilst=function(t,n,e){t()?n(function(r){return r?e(r):void i.whilst(t,n,e)}):e()},i.doWhilst=function(t,n,e){t(function(r){if(r)return e(r);var o=Array.prototype.slice.call(arguments,1);n.apply(null,o)?i.doWhilst(t,n,e):e()})},i.until=function(t,n,e){t()?e():n(function(r){return r?e(r):void i.until(t,n,e)})},i.doUntil=function(t,n,e){t(function(r){if(r)return e(r);var o=Array.prototype.slice.call(arguments,1);n.apply(null,o)?e():i.doUntil(t,n,e)})},i.queue=function(t,n){function r(t,n,e,r){return t.started||(t.started=!0),u(n)||(n=[n]),0==n.length?i.setImmediate(function(){t.drain&&t.drain()}):void c(n,function(n){var o={data:n,callback:"function"==typeof r?r:null};e?t.tasks.unshift(o):t.tasks.push(o),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),i.setImmediate(t.process)})}void 0===n&&(n=1);var o=0,a={tasks:[],concurrency:n,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(t,n){r(a,t,!1,n)},kill:function(){a.drain=null,a.tasks=[]},unshift:function(t,n){r(a,t,!0,n)},process:function(){if(!a.paused&&o<a.concurrency&&a.tasks.length){var n=a.tasks.shift();a.empty&&0===a.tasks.length&&a.empty(),o+=1;var r=function(){o-=1,n.callback&&n.callback.apply(n,arguments),a.drain&&a.tasks.length+o===0&&a.drain(),a.process()},i=e(r);t(n.data,i)}},length:function(){return a.tasks.length},running:function(){return o},idle:function(){return a.tasks.length+o===0},pause:function(){a.paused!==!0&&(a.paused=!0,a.process())},resume:function(){a.paused!==!1&&(a.paused=!1,a.process())}};return a},i.priorityQueue=function(t,n){function e(t,n){return t.priority-n.priority}function r(t,n,e){for(var r=-1,o=t.length-1;o>r;){var i=r+(o-r+1>>>1);e(n,t[i])>=0?r=i:o=i-1}return r}function o(t,n,o,a){return t.started||(t.started=!0),u(n)||(n=[n]),0==n.length?i.setImmediate(function(){t.drain&&t.drain()}):void c(n,function(n){var u={data:n,priority:o,callback:"function"==typeof a?a:null};t.tasks.splice(r(t.tasks,u,e)+1,0,u),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),i.setImmediate(t.process)})}var a=i.queue(t,n);return a.push=function(t,n,e){o(a,t,n,e)},delete a.unshift,a},i.cargo=function(t,n){var e=!1,r=[],o={tasks:r,payload:n,saturated:null,empty:null,drain:null,drained:!0,push:function(t,e){u(t)||(t=[t]),c(t,function(t){r.push({data:t,callback:"function"==typeof e?e:null}),o.drained=!1,o.saturated&&r.length===n&&o.saturated()}),i.setImmediate(o.process)},process:function a(){if(!e){if(0===r.length)return o.drain&&!o.drained&&o.drain(),void(o.drained=!0);var i="number"==typeof n?r.splice(0,n):r.splice(0,r.length),u=l(i,function(t){return t.data});o.empty&&o.empty(),e=!0,t(u,function(){e=!1;var t=arguments;c(i,function(n){n.callback&&n.callback.apply(null,t)}),a()})}},length:function(){return r.length},running:function(){return e}};return o};var w=function(t){return function(n){var e=Array.prototype.slice.call(arguments,1);n.apply(null,e.concat([function(n){var e=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(n?console.error&&console.error(n):console[t]&&c(e,function(n){console[t](n)}))}]))}};i.log=w("log"),i.dir=w("dir"),i.memoize=function(t,n){var e={},r={};n=n||function(t){return t};var o=function(){var o=Array.prototype.slice.call(arguments),a=o.pop(),u=n.apply(null,o);u in e?i.nextTick(function(){a.apply(null,e[u])}):u in r?r[u].push(a):(r[u]=[a],t.apply(null,o.concat([function(){e[u]=arguments;var t=r[u];delete r[u];for(var n=0,o=t.length;o>n;n++)t[n].apply(null,arguments)}])))};return o.memo=e,o.unmemoized=t,o},i.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},i.times=function(t,n,e){for(var r=[],o=0;t>o;o++)r.push(o);return i.map(r,n,e)},i.timesSeries=function(t,n,e){for(var r=[],o=0;t>o;o++)r.push(o);return i.mapSeries(r,n,e)},i.seq=function(){var t=arguments;return function(){var n=this,e=Array.prototype.slice.call(arguments),r=e.pop();i.reduce(t,e,function(t,e,r){e.apply(n,t.concat([function(){var t=arguments[0],n=Array.prototype.slice.call(arguments,1);r(t,n)}]))},function(t,e){r.apply(n,[t].concat(e))})}},i.compose=function(){return i.seq.apply(null,Array.prototype.reverse.call(arguments))};var A=function(t,n){var e=function(){var e=this,r=Array.prototype.slice.call(arguments),o=r.pop();return t(n,function(t,n){t.apply(e,r.concat([n]))},o)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return e.apply(this,r)}return e};i.applyEach=p(A),i.applyEachSeries=v(A),i.forever=function(t,n){function e(r){if(r){if(n)return n(r);throw r}t(e)}e()},"undefined"!=typeof n&&n.exports?n.exports=i:"undefined"!=typeof define&&define.amd?define([],function(){return i}):r.async=i}()}).call(this,t("_process"))},{_process:3}],3:[function(t,n){function e(){if(!a){a=!0;for(var t,n=i.length;n;){t=i,i=[];for(var e=-1;++e<n;)t[e]();n=i.length}a=!1}}function r(){}var o=n.exports={},i=[],a=!1;o.nextTick=function(t){i.push(t),a||setTimeout(e,0)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=r,o.addListener=r,o.once=r,o.off=r,o.removeListener=r,o.removeAllListeners=r,o.emit=r,o.binding=function(){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],4:[function(t,n){n.exports={timeConvert:function(t){var n=Math.floor(t/60),e=t-60*n,r=Math.floor(e),o=r.toString().split("");return 1===o.length?n+":0"+r:n+":"+r},renderNote:function(t){var n=$("<tr>");return n.attr("data-note",t._id),n.attr("id",t._id),n.attr("class","note-row"),n.append('<td><button class="set-time btn btn-default" data-set-time="'+t.time+'">'+t.displayTime+"</button><p>"+t.note+"</p></td>"),n}}},{}]},{},[1]);